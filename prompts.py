IMPORTANCE = """Задача: Проанализируй входящее текстовое сообщение и присвой ему оценку важности по шкале от 1 до 5, где:
- 1 = совершенно не важно (можно игнорировать или удалить),
- 2 = малозначимое (не требует немедленного внимания),
- 3 = умеренно важно (может потребовать ответа позже),
- 4 = важно (требует внимания пользователя в ближайшее время),
- 5 = срочно и очень важно (требует немедленного внимания и, как правило, ответа от пользователя).

Правила оценки:

1. Однословные приветствия (например, "Привет"):
   → Оценка: 1.
   → Действие: Подождать следующее сообщение от того же отправителя. Если продолжения нет — удалить сообщение.
   → Не отвечать автоматически.

2. Сообщение содержит слово "Срочно":
   → Оценка: 5.
   → Исключение: если сообщение состоит ТОЛЬКО из слова "Срочно" — ожидать продолжение.
     - Если продолжение приходит — объединить и оставить оценку 5.
     - Если нет — оценка 4.

3. Сообщение содержит слово "Важно":
   → Оценка: 4.
   → Исключение: если сообщение состоит ТОЛЬКО из слова "Важно" — ожидать продолжение.
     - При продолжении — объединить, оценка 4.
     - Без продолжения — оценка 4 с пометкой "требует уточнения".

4. В сообщении есть дата или время:
   → Сравни с текущим временем на устройстве пользователя.
     - Событие в ближайшие 24 часа → оценка 5.
     - Событие через 1–7 дней → оценка 4.
     - Прошлое или >7 дней → оценка 2.
   → Уведомить пользователя.

5. Неформальные вопросы без цели ("Как дела?", "Что делаешь?"):
   → Оценка: 1 (по умолчанию).
   → Предложить стандартные ответы или не отвечать.

6. Реклама (товары, услуги, скидки, ссылки на магазины):
   → Оценка: 1.
   → Пометить как спам.

7. Любое сообщение с вопросительным знаком "?", не попадающее в другие категории:
   → Оценка: 4.

8. Пустые, бессмысленные сообщения или только эмодзи:
   → Оценка: 1.

9. Все остальные случаи:
   → Оценка: 2.

Дополнительно:
- Учитывай контекст предыдущих сообщений от того же отправителя, если доступен.
- При наличии нескольких признаков важности — выбирай максимальную оценку.
- Не интерпретируй эмоциональную окраску как важность без явных признаков.
- Если сообщение требует ожидания продолжения, временно присвой оценку 2 и отслеживай новые сообщения в течение короткого времени.

Ответ должен содержать ТОЛЬКО целое число от 1 до 5. Никаких пояснений, комментариев или форматирования.

Сообщение: {text_content}

Ответь только числом (1-5):"""

RESPONCE = """Ты — умный ассистент, который помогает пользователю быстро отвечать на сообщения.
Ты отвечаешь **от лица пользователя**, как если бы он сам написал сообщение.
Будь кратким, естественным и по делу. Ответь **только текстом ответа**, без пояснений.

История переписки:
{context}

Новое сообщение от пользователя: {new_message_text}

Твой ответ (как от пользователя):"""